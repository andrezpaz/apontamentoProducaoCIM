<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Dashboard com filtro automático</title>
</head>
<body>
  <script>
    window.addEventListener('DOMContentLoaded', () => {
      const dashboardUrl = "http://autoflex.bazei.com.br:7000/auto-login/fi3oo8knu5";

      // Primeiro iframe oculto para configurar o localStorage no domínio correto
      const preparador = document.createElement('iframe');
      preparador.style.display = 'none';
      preparador.src = dashboardUrl;

      preparador.onload = () => {
        setTimeout(() => {
          try {
            preparador.contentWindow.localStorage.setItem(
              'autoflex/app/dashboard-filter',
              JSON.stringify(['02-IMPRESSORAS-0001-0208'])
            );

            // Agora carrega o iframe visível com o filtro já salvo
            const dashboard = document.createElement('iframe');
            dashboard.src = dashboardUrl;
            dashboard.width = "100%";
            dashboard.height = "800";
            dashboard.frameBorder = "0";

            document.body.appendChild(dashboard);
          } catch (e) {
            console.error('Erro ao acessar localStorage no iframe:', e);
          }
        }, 800); // ajustável conforme o carregamento da página
      };

      document.body.appendChild(preparador);
    });
  </script>
</body>
</html>
